<html>

<head>
  <script src="//www.google.com/jsapi"></script>
  <script>window.parent.maeExportApis_();</script>


  <base target="_top">
  <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    const MAX_ALLOWED_CELLS = 5000000;
    const UPDATE_INTERVAL_MS = 1500

    google.charts.load('current', { 'packages': ['gauge'] });
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {

      var data = google.visualization.arrayToDataTable([
        ['Label', 'Value'],
        ['% Full', 0],
      ]);

      var options = {
        width: 280, height: 280,
        greenFrom: 0, greenTo: 90,
        redFrom: 95, redTo: 100,
        yellowFrom: 90, yellowTo: 95,
        minorTicks: 5,
        animation: {
          easing: 'out'
        }
      };

      var chart = new google.visualization.Gauge(document.getElementById('chart_div'));

      chart.draw(data, options);

      setInterval(updateChart, UPDATE_INTERVAL_MS);

      function updateChart() {

        google.script.run.withSuccessHandler(onGetUsageStatsSuccess)
          .withFailureHandler(function () {
            console.log('Error determining percent full');
          }).getUsageStats();

        function onGetUsageStatsSuccess(sheets) {

          var largestSheetName;
          var largestSheetNumCells = 0;
          var totalNumCells = 0;
          sheets.forEach(function (sheet) {
            var numCellsOnSheet = sheet.maxRows * sheet.maxColumns;
            if (numCellsOnSheet > largestSheetNumCells) {
              largestSheetNumCells = numCellsOnSheet;
              largestSheetName = sheet.name;
            }
            totalNumCells += numCellsOnSheet;
          });

          var percentFull = totalNumCells / MAX_ALLOWED_CELLS * 100;

          var percentFullStr = Number(totalNumCells / MAX_ALLOWED_CELLS).toLocaleString(undefined, { style: 'percent' });
          var largestSheetNumCellsStr = Number(largestSheetNumCells).toLocaleString();
          var totalNumCellsStr = Number(totalNumCells).toLocaleString();

          var messageElement = document.getElementById("message");

          messageElement.innerHTML = '<p>Each Google Sheet spreadsheet can support up to 5 million cells. Your spreadsheet is currently '
            + percentFullStr + " full with "
            + totalNumCellsStr + " cells."

          var largestSheetMessageText = document.createTextNode('Your largest sheet is "' + largestSheetName + '", which contains '
            + largestSheetNumCellsStr + ' cells.');

          messageElement.appendChild(largestSheetMessageText);

          data.setValue(0, 1, percentFull);
          chart.draw(data, options);
        }
      }
    }
  </script>
  <script type="text/javascript" charset="UTF-8" src="https://www.gstatic.com/charts/49/loader.js"></script>
  <link id="load-css-0" rel="stylesheet" type="text/css" href="https://www.gstatic.com/charts/49/css/core/tooltip.css">
  <link id="load-css-1" rel="stylesheet" type="text/css" href="https://www.gstatic.com/charts/49/css/util/util.css">
  <script type="text/javascript" charset="UTF-8"
    src="https://www.gstatic.com/charts/49/js/jsapi_compiled_default_module.js"></script>
  <script type="text/javascript" charset="UTF-8"
    src="https://www.gstatic.com/charts/49/js/jsapi_compiled_graphics_module.js"></script>
  <script type="text/javascript" charset="UTF-8"
    src="https://www.gstatic.com/charts/49/js/jsapi_compiled_ui_module.js"></script>
  <script type="text/javascript" charset="UTF-8"
    src="https://www.gstatic.com/charts/49/js/jsapi_compiled_gauge_module.js"></script>
</head>

<body data-gr-ext-disabled="forever">
  <div class="sidebar">
    <div id="chart_div" style="width: 280px; height: 280px;">
      <table cellpadding="0" cellspacing="0" align="center" style="border: 0px; padding: 0px; margin: 0px;">
        <tbody>
          <tr style="border: 0px; padding: 0px; margin: 0px;">
            <td style="border: 0px; padding: 0px; margin: 0px; width: 280px;">
              <div style="position: relative;">
                <div dir="ltr" style="position: relative; width: 280px; height: 280px;">
                  <div style="position: absolute; left: 0px; top: 0px; width: 100%; height: 100%;"><svg width="280"
                      height="280" aria-label="A chart." style="overflow: hidden;">
                      <defs id="_ABSTRACT_RENDERER_ID_0"></defs>
                      <g>
                        <circle cx="139.5" cy="139.5" r="126" stroke="#333333" stroke-width="1" fill="#cccccc"></circle>
                        <circle cx="139.5" cy="139.5" r="113" stroke="#e0e0e0" stroke-width="2" fill="#f7f7f7"></circle>
                        <path
                          d="M62.92536085066632,217.07463914933368A109,109,0,1,1,243.66516027617172,173.68285238686926L217.74887020712882,165.26213929015194A81.75,81.75,0,1,0,82.19402063799974,197.80597936200027Z"
                          stroke="none" stroke-width="0" fill="#109618"></path>
                        <path
                          d="M243.66516027617175,173.68285238686923A109,109,0,0,1,232.93777791459604,196.9523435540384L209.70333343594706,182.71425766552878A81.75,81.75,0,0,0,217.7488702071288,165.26213929015194Z"
                          stroke="none" stroke-width="0" fill="#ff9900"></path>
                        <path
                          d="M232.9377779145961,196.95234355403835A109,109,0,0,1,217.07463914933368,217.07463914933368L197.80597936200033,197.8059793620002A81.75,81.75,0,0,0,209.70333343594706,182.7142576655288Z"
                          stroke="none" stroke-width="0" fill="#dc3912"></path><text text-anchor="middle" x="140"
                          y="111.8" font-family="arial" font-size="28" stroke="none" stroke-width="0" fill="#333333">%
                          Full</text><text text-anchor="start" x="83.64358953943216" y="201.60641046056784"
                          font-family="arial" font-size="15" stroke="none" stroke-width="0" fill="#333333">0</text><text
                          text-anchor="end" x="196.3564104605679" y="201.60641046056776" font-family="arial"
                          font-size="15" stroke="none" stroke-width="0" fill="#333333">100</text>
                        <path
                          d="M56.35599987686355,191.2571091986346L47.06222208540396,196.95234355403844M46.70135575144543,170.31456714818236L36.33483972382827,173.68285238686929M42.20240956078014,147.6968372909016L31.336010623089052,148.5520414343351M43.10777378761698,124.65377897955337L32.34197087512999,122.94864331061486M60.635432851817654,82.33826675010839L51.81714761313073,75.93140750012044M76.28914645880894,65.40417477463699L69.21016273200993,57.11574974959666M95.46353197555044,52.59225997712112L90.51503552838938,42.88028886346791M117.0990098057357,44.61051080898791L114.55445533970634,34.01167867665325M162.90099019426427,44.6105108089879L165.44554466029362,34.01167867665323M184.53646802444953,52.59225997712109L189.48496447161057,42.88028886346788M203.71085354119106,65.40417477463697L210.78983726799004,57.115749749596645M219.36456714818235,82.33826675010836L228.18285238686926,75.9314075001204M236.892226212383,124.65377897955332L247.65802912486998,122.94864331061481M237.79759043921987,147.69683729090153L248.66398937691096,148.55204143433502M233.29864424855458,170.31456714818233L243.66516027617175,173.68285238686923M223.6440001231365,191.2571091986345L232.9377779145961,196.95234355403835"
                          stroke="#666666" stroke-width="1" fill-opacity="1" fill="none"></path>
                        <path
                          d="M78.34028868053306,201.65971131946696L62.92536085066632,217.07463914933368M59.43770476501578,106.63000469776422L39.297130956269726,98.28750587220527M139.99999999999997,52.8L139.99999999999997,31M220.56229523498422,106.63000469776419L240.70286904373026,98.28750587220523M201.65971131946702,201.65971131946688L217.0746391493338,217.0746391493336"
                          stroke="#333333" stroke-width="2" fill-opacity="1" fill="none"></path>
                        <g><text text-anchor="middle" x="140" y="231.8" font-family="arial" font-size="28" stroke="none"
                            stroke-width="0" fill="#000000">4.935</text>
                          <path
                            d="M51.49213005674339,194.61096005480562C135.99344591136378,133.50658608012455,166.080950918446,119.42481533036434,168.08422796276412,122.67152229030206C170.08750500708223,125.91822925023979,144.00655408863622,146.49341391987545,51.49213005674339,194.61096005480562"
                            stroke="#c63310" stroke-width="1" fill-opacity="0.7" fill="#dc3912"></path>
                          <circle cx="139.5" cy="139.5" r="16" stroke="#666666" stroke-width="1" fill="#4684ee">
                          </circle>
                        </g>
                      </g>
                    </svg></div>
                </div>
                <div aria-hidden="true"
                  style="display: none; position: absolute; top: 290px; left: 290px; white-space: nowrap; font-family: Arial; font-size: 8px;">
                  -._.-*^*-._.-*^*-._.-</div>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div id="message">
      <p>Each Google Sheet spreadsheet can support up to 5 million cells. Your spreadsheet is currently 5% full with
        246,753 cells.</p>Your largest sheet is "people_personTab", which contains 138,429 cells.
    </div>
    <div class="secondary">
      <p style="text-align:center;">Powered by Tiller, the effortless way to automatically feed your bank data into a
        Google Sheet.</p>
    </div>
    <div style="text-align:center">
      <a href="https://www.tillerhq.com?utm_medium=SizeMySheet&amp;utm_source=AddOn&amp;utm_campaign=SidebarLearnMore">Learn
        more about Tiller here</a>
    </div>
  </div>




</body>

</html>