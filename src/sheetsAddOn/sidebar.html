<html>

<head>
    <base target="_top" />

    <?!= HtmlService.createHtmlOutputFromFile('sheetsAddOn/sidebar-stylesheet').getContent(); ?>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2E9D6LC489"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-2E9D6LC489');
    </script>
</head>

<body class="container">
    <header>
        <img src="https://savvytoolbelt.com/wp-content/uploads/2020/09/Savvy-Tool-Belt_Horizontal_Color_on-Light.png"
            class="logo">
        <h1 class="heroText">Metrics For Ministry</h1>
        </div>
    </header>

    <content>
        <div id="menuDiv" class="">
            <div class="contentOption" id="syncNowButton">
                <div class="contentSubOptionImg column1">
                    <?!= HtmlService.createHtmlOutputFromFile('assets/refreshIcon').getContent(); ?>
                </div>
                <div class="contentSubOptionInfo column2">
                    <div id="syncNowContent">
                        <h3>Update Sheets</h3>
                        <p>Update the PCO Data</p>
                    </div>

                    <div id="syncNowProgressBar" class="hidden">
                        <div id="myBar">
                        </div>
                    </div>

                </div>

            </div>
            <div class="contentOption" id="infoButton">
                <div class="contentSubOptionImg column1">
                    <?!= HtmlService.createHtmlOutputFromFile('assets/infoIcon').getContent(); ?>
                </div>
                <div class="contentSubOptionInfo column2">
                    <h3>Info</h3>
                    <p>Last sync time, modules, and more.</p>
                </div>
            </div>
            <div class="contentOption" id="settingsButton">
                <div class="contentSubOptionImg column1">
                    <?!= HtmlService.createHtmlOutputFromFile('assets/settingsIcon').getContent(); ?>
                </div>
                <div class="contentSubOptionInfo column2">
                    <h3>Settings</h3>
                    <p>Configure your login and PCO Modules</p>
                </div>
            </div>
            <div class="contentOption" id="helpButton">
                <div class="contentSubOptionImg column1">
                    <?!= HtmlService.createHtmlOutputFromFile('assets/learnMore').getContent(); ?>
                </div>
                <div class="contentSubOptionInfo column2">
                    <h3>Help</h3>
                    <p>Access to our documentation.</p>
                </div>
            </div>
            <div class="contentOption" id="gdsConnectorButton">
                <div class="contentSubOptionImg column1">
                    <?!= HtmlService.createHtmlOutputFromFile('assets/gdsConnectorSVG').getContent(); ?>

                </div>
                <div class="contentSubOptionInfo column2">
                    <h3>GDS Connector</h3>
                    <p>Click here to link create a new Google Data Studio Connector</p>
                </div>
            </div>
            <div class="contentOption" id="tipJarButton">
                <div class="contentSubOptionImg column1">
                    <?!= HtmlService.createHtmlOutputFromFile('assets/jar').getContent(); ?>

                </div>
                <div class="contentSubOptionInfo column2">
                    <h3>Donate</h3>
                    <p>Help us keep this tool free for all churches!</p>
                </div>
            </div>
        </div>
        <div id="settingsDiv" class="page hidden">
            <h2>Settings</h2>
            <p>Configure your login and PCO Modules</p>
            <div class="configurationOptions">

                <p>
                    <strong>Select the modules you want enabled:</strong></br>
                    People is required, and enabled by default.
                </p>
                <!-- Module Selector -->
                <!-- This gets hidden when authorized.-->
                <div class="row" id="elementDiv">
                    <div class="column">
                        <input class="pcoModuleSelector" type="checkbox" id="givingModule" name="giving" value="giving">
                        <label>Giving</label></br>
                        <input class="pcoModuleSelector" type="checkbox" id="checkinsModuleSelector" name="check_ins"
                            value="check_ins">
                        <label>Check-ins</label></br>
                        <input class="pcoModuleSelector" type="checkbox" id="groupsModuleSelector" name="groups"
                            value="groups">
                        <label>Groups</label></br>
                    </div>
                    <div class="column">
                        <input class="pcoModuleSelector" type="checkbox" id="peopleModuleSelector" name="people"
                            value="people" checked disabled>
                        <label>People</label></br>
                        <!-- <input class="pcoModuleSelector" type="checkbox" id="resourcesModuleSelector" name="calendar"
                            value="calendar">
                        <label>Calendar</label></br>
                        <input class="pcoModuleSelector" type="checkbox" id="servicesModuleSelector" name="services"
                            value="services">
                        <label>Services</label></br> -->
                    </div>
                </div>
            </div>

            <!-- <div id="dateSelectorDiv"> 

            </div>-->

            <!-- Authorization Button. -->
            <!-- This gets hidden when authorized.-->
            <div class="authorizeDiv header">
                <button id="btn-authorize" class="action">Authorize with PCO</button>

            </div>

            <div class="settingsSyncButtons">

                <div class="contentOption" id="setupDocument">
                    <div class="contentSubOptionImg column1">
                        <?!= HtmlService.createHtmlOutputFromFile('assets/documentIcon').getContent(); ?>
                    </div>
                    <div class="contentSubOptionInfo column2">
                        <div id="syncNowContent">
                            <h3>Setup Document</h3>
                            <p>Setup the Sheets Document</p>
                        </div>
                    </div>
                </div>
                <div class="contentOption" id="logOutButton">
                    <div class="contentSubOptionImg column1">
                        <?!= HtmlService.createHtmlOutputFromFile('assets/logoutIcon').getContent(); ?>
                    </div>
                    <div class="contentSubOptionInfo column2">
                        <div id="syncNowContent">
                            <h3>Logout/Reset</h3>
                            <p>This clears all data in Google Sheets and logs out of PCO.</p>
                        </div>
                    </div>

                </div>
                <div class="contentOption backToHomeButton" id="backToHomeButton-settings">
                    <div class="contentSubOptionImg column1">
                        <?!= HtmlService.createHtmlOutputFromFile('assets/backButtonSVG').getContent(); ?>
                    </div>
                    <div class="contentSubOptionInfo column2">
                        <div id="syncNowContent">
                            <h3>Back</h3>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <div id="infoDiv" class="page hidden">
            <h2>Info</h2>
            <p>Last sync time, modules, and more.</p>

            <div class="infoContentDivsContainer">
                <div class="infoContentDivs">
                    <h3>PCO Organization</h3>
                    <p>
                        <?= getUserProperty("org_name"); ?>
                    </p>
                </div>
                <div class="infoContentDivs">
                    <h3>Last Sync Time</h3>
                    <p>
                        <?= getUserProperty("lastSyncTime"); ?>
                    </p>
                </div>
                <!-- <div class="infoContentDivs">
                    <h3>Sync Start Date</h3>
                    <p>
                        <?= getUserProperty("dateSelectorDiv"); ?>
                    </p>
                </div> -->
                <div class="infoContentDivs">
                    <h3>Modules Enabled</h3>
                    <p>
                        <?= getUserProperty("requestedModules"); ?>
                    </p>
                </div>
                <div class="infoContentDivs">
                    <h3>Time Zone</h3>
                    <p>
                        <?= getUserProperty("time_zone"); ?>
                    </p>
                </div>
                <div class="infoContentDivs">
                    <h3>Date Format</h3>
                    <p>
                        <?= getUserProperty("date_format"); ?>
                    </p>
                </div>
                <div class="infoContentDivs">
                    <h3>Total % Storage</h3>
                    <p>
                        <?= totalStorageUsed(); ?> %
                    </p>
                </div>
                <div class="infoContentDivs">
                    <h3>Spreadsheet ID</h3>
                    <p>
                        <?= getUserProperty("activeSpreadsheetID");; ?>
                    </p>
                </div>
            </div>

            <div class="contentOption backToHomeButton" id="backToHomeButton-info">
                <div class="contentSubOptionImg column1">
                    <?!= HtmlService.createHtmlOutputFromFile('assets/backButtonSVG').getContent(); ?>
                </div>
                <div class="contentSubOptionInfo column2">
                    <div id="syncNowContent">
                        <h3>Back</h3>
                    </div>
                </div>
            </div>

        </div>
    </content>

    <footer>
        <span>This plugin was built by Savvy Tool Belt and is not affiliated with Planning Center.</span>
        <span id="emailContact"><a href="hello@savvytoolbelt.com">hello@savvytoolbelt.com</a></span>
        <p class="copyright" id='copyright'>©<a href="https://savvytoolbelt.com">SavvyToolBelt</a> 2019-2021.</p>
    </footer>

    <?!= HtmlService.createHtmlOutputFromFile('sheetsAddOn/sidebar-javascript').getContent(); ?>


</body>

</html>